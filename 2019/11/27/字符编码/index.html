<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="你应该知道的字符编码">
<meta name="keywords" content="字符编码">
<meta property="og:type" content="article">
<meta property="og:title" content="字符编码">
<meta property="og:url" content="http://yoursite.com/2019/11/27/字符编码/index.html">
<meta property="og:site_name" content="FINO ALLA FINE">
<meta property="og:description" content="你应该知道的字符编码">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/images/JavaScript/note.png">
<meta property="og:image" content="http://yoursite.com/images/JavaScript/server.png">
<meta property="og:image" content="http://yoursite.com/images/JavaScript/encode-vscode.png">
<meta property="og:image" content="http://yoursite.com/images/JavaScript/encode-8859.png">
<meta property="og:image" content="http://yoursite.com/images/JavaScript/btn-1.png">
<meta property="og:image" content="http://yoursite.com/images/JavaScript/btn-2.png">
<meta property="og:image" content="http://yoursite.com/images/JavaScript/gb-18030.png">
<meta property="og:updated_time" content="2019-11-27T13:28:18.587Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="字符编码">
<meta name="twitter:description" content="你应该知道的字符编码">
<meta name="twitter:image" content="http://yoursite.com/images/JavaScript/note.png">
  <link rel="canonical" href="http://yoursite.com/2019/11/27/字符编码/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>字符编码 | FINO ALLA FINE</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">FINO ALLA FINE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/27/字符编码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Hu">
      <meta itemprop="description" content="Developer, Juventino">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FINO ALLA FINE">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">字符编码

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-11-27 08:21:06 / 修改时间：21:28:18" itemprop="dateCreated datePublished" datetime="2019-11-27T08:21:06+08:00">2019-11-27</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/技术/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span>

                
                
              
            </span>
          

          
            <div class="post-description">你应该知道的字符编码</div>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>因为计算机只能处理 0/1，如果要处理文本，就必须先把文本转换为数字才能处理。最早的计算机在设计时采用 <strong>8 个比特（bit）作为一个字节（byte）</strong>，所以，一个字节能表示的最大的整数就是 255（二进制 11111111=十进制 255），如果要表示更大的整数，就必须用更多的字节。比如 2 个字节可以表示的最大整数是 65535，4 个字节可以表示的最大整数是 4294967295。</p>
<p>为了能让计算机正确处理文本，需要一种机制，通过编码和解码，能让使用者和计算机和谐共处。</p>
<h2 id="ASCII-–-gt-Unicode-–-gt-UTF-8"><a href="#ASCII-–-gt-Unicode-–-gt-UTF-8" class="headerlink" title="ASCII –&gt; Unicode –&gt; UTF-8"></a>ASCII –&gt; Unicode –&gt; UTF-8</h2><p>由于计算机是美国人发明的，因此，最早只有 127 个字符被编码到计算机里，也就是大小写英文字母、数字和一些符号，这个编码表被称为 ASCII 编码，比如大写字母 A 的编码是 65，小写字母 z 的编码是 122。</p>
<p>但是要处理中文显然一个字节是不够的，至少需要两个字节，而且还不能和 ASCII 编码冲突，所以，中国制定了 GB2312 编码，用来把中文编进去。</p>
<p>你可以想得到的是，全世界有上百种语言，日本把日文编到 Shift_JIS 里，韩国把韩文编到 Euc-kr 里，各国有各国的标准，就会不可避免地出现冲突，结果就是，在多语言混合的文本中，显示出来会有乱码。</p>
<p>因此，Unicode 应运而生。Unicode 把所有语言都统一到一套编码里，这样就不会再有乱码问题了。</p>
<p>Unicode 标准也在不断发展，但最常用的是用<strong>两个字节表示一个字符</strong>（如果要用到非常偏僻的字符，就需要 4 个字节）。现代操作系统和大多数编程语言都直接支持 Unicode。</p>
<p>ASCII 编码和 Unicode 编码的区别：</p>
<p><strong>ASCII 编码是 1 个字节，而 Unicode 编码通常是 2 个字节</strong>。</p>
<p>字母 A 用 ASCII 编码是十进制的 65，二进制的 01000001；</p>
<p>字符 0 用 ASCII 编码是十进制的 48，二进制的 00110000，注意字符’0’和整数 0 是不同的；</p>
<p>汉字“中”已经超出了 ASCII 编码的范围，用 Unicode 编码是十进制的 20013，二进制的 01001110 00101101。</p>
<p>你可以猜测，如果把 ASCII 编码的 A 用 Unicode 编码，只需要在前面补 0 就可以，因此，A 的 Unicode 编码是 00000000 01000001。</p>
<p>新的问题又出现了：如果统一成 Unicode 编码，乱码问题从此消失了。但是，如果你写的文本基本上全部是英文的话，用 Unicode 编码比 ASCII 编码需要多一倍的存储空间，在存储和传输上就十分不划算。</p>
<p>所以，本着节约的精神，又出现了把 Unicode 编码转化为“可变长编码”的 UTF-8 编码。UTF-8 编码把一个 Unicode 字符根据不同的数字大小编码成 1-6 个字节，常用的英文字母被编码成 1 个字节，汉字通常是 3 个字节，只有很生僻的字符才会被编码成 4-6 个字节。如果你要传输的文本包含大量英文字符，用 UTF-8 编码就能节省空间：</p>
<table>
<thead>
<tr>
<th>字符</th>
<th>ASCII</th>
<th>Unicode</th>
<th>UTF-8</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>01000001</td>
<td>00000000 01000001</td>
<td>01000001</td>
</tr>
<tr>
<td>中</td>
<td>无</td>
<td>01001110 00101101</td>
<td>11100100 10111000 10101101</td>
</tr>
</tbody></table>
<p>从上面的表格还可以发现，UTF-8 编码有一个额外的好处，就是 <strong>ASCII 编码实际上可以被看成是 UTF-8 编码的一部分</strong>，所以，大量只支持 ASCII 编码的历史遗留软件可以在 UTF-8 编码下继续工作。</p>
<p>搞清楚了 ASCII、Unicode 和 UTF-8 的关系，我们就可以总结一下现在计算机系统通用的字符编码工作方式：</p>
<blockquote>
<p><del><strong>在计算机内存中，统一使用 Unicode 编码。当需要保存到硬盘或者需要传输的时候，就转换为 UTF-8 编码。</strong></del></p>
</blockquote>
<p>以上是网上一篇文章的误读。原因是 Windows 的记事本，微软喜欢在内存里处理 UTF-16，而且记事本有个 bug，将 UTF-16 显示为了 Unicode。但是，这个例子任然能解释应用处理字符的过程。</p>
<p><strong>在内存中使用定长的编码（UTF-16 是其中一种）会有更优的性能，具体用什么编码不是一定的，看怎么实现而已。而传输和存储要节省空间的话，当然就采用可变长度的 UTF-8 更好。</strong></p>
<p>用记事本编辑的时候，从硬盘文件读取的 UTF-8 字符被转换为 Unicode 字符到内存里，编辑完成保存的时候再把 Unicode 字符转换为 UTF-8 字符保存到文件中：</p>
<p><img src="/images/JavaScript/note.png" alt="note"></p>
<p>浏览网页的时候，服务器会把动态生成的 Unicode 内容转换为 UTF-8 再传输到浏览器：</p>
<p><img src="/images/JavaScript/server.png" alt="server"></p>
<p>所以你看到很多网页的源码上会有类似<code>&lt;meta charset=&quot;UTF-8&quot; /&gt;</code>的信息，表示该网页正是用的 UTF-8 编码。</p>
<p>所谓编码方式，就是指文件书写时选择的编码方式，一般显示在编辑器最下面</p>
<p><img src="/images/JavaScript/encode-vscode.png" alt="encode-vscode"></p>
<p><strong>JavaScript 的处理机制会将字符编码方式转化为 UTF-16</strong>。无论 JavaScript 文件是用哪种编码编写的，在执行前 JavaScript 都会将编码变为 UTF-16。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s1 = <span class="string">"\u00E9"</span>; <span class="comment">//é</span></span><br><span class="line"><span class="keyword">const</span> s2 = <span class="string">"\u0065\u0301"</span>; <span class="comment">//é</span></span><br><span class="line"><span class="keyword">const</span> s3 = <span class="string">"e\u0301"</span>; <span class="comment">//é</span></span><br><span class="line">s3.length === <span class="number">2</span>; <span class="comment">//true</span></span><br><span class="line">s2 === s3; <span class="comment">//true</span></span><br><span class="line">s1 !== s3; <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h2 id="编码方式不一致会出现一些比较奇怪的现象"><a href="#编码方式不一致会出现一些比较奇怪的现象" class="headerlink" title="编码方式不一致会出现一些比较奇怪的现象"></a>编码方式不一致会出现一些比较奇怪的现象</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset="</span><span class="attr">UTF-8</span>"&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> localCustName = <span class="string">"José"</span>;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params">custName</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (custName == <span class="literal">null</span> || custName == <span class="string">"undefined"</span>) &#123;</span></span><br><span class="line"><span class="javascript">          custName = <span class="string">"world"</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        alert(<span class="string">"Hello, "</span> + custName);</span></span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./remoteCustName.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"sayHello(localCustName)"</span>&gt;</span></span><br><span class="line">        BTN 1: Say hello to local José</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"sayHello(remoteCustName)"</span>&gt;</span></span><br><span class="line">        BTN 2: Say hello to remote José</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>HTML 的编码方式是 UTF-8， 但是它引入的 remoteCustName.js 的编码方式是 ISO-8859-1</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// this file is encoded as charset = 8859-1</span></span><br><span class="line"><span class="keyword">var</span> remoteCustName = <span class="string">"José"</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/images/JavaScript/encode-8859.png" alt="encode-8859"></p>
<p>当点击 BTN 1 时，显示下图：</p>
<p><img src="/images/JavaScript/btn-1.png" alt="btn-1"></p>
<p>当点击 BTN 2 时，显示</p>
<p><img src="/images/JavaScript/btn-2.png" alt="btn-2"></p>
<p>出现这种现象的原因是，浏览器并不知道 remoteCustName.js 文件的编码方式时什么，只好默认它也是 UTF-8，然而实际上它是 ISO-8859-1，这就会导致出现错误。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>在引入时写明采用了什么编码，<code>&lt;script type=&quot;text/javascript&quot; charset=&quot;ISO-8859-1&quot; src=&quot;./remoteCustName.js&quot;&gt;&lt;/script&gt;</code>。这样浏览器就会用正确的方式加载字符集。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>所有的编码标准实际上都做了两件事情，第一件就是为所有需要编码的字符进行一个编号或标识，第二件就是指定一个规则统一得将这个编号或标识与二进制串进行一个映射。</p>
<p>一句话总结：当我们编写文件的时候，会指定编码(比如： UTF-8)。然后，我们开始打字(比如：“A”)，屏幕上显示出来的是就是这个编码下对应的字符(比如：“A”)。由于计算机真正存储的是一串 0 和 1，编码中使用经常使用十六进制的码点来表示字符，所以<strong>实际存储进内存/硬盘的是这个编码中该字符对应的码点对应的二进制</strong>，也就是这一串 0 和 1(比如：<code>0100 0001</code>)。</p>
<table>
<thead>
<tr>
<th>屏幕上显示的字符</th>
<th>编码中对应的码点(十六进制)</th>
<th>真正存储进文件的内容(二进制)</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>41</td>
<td>0100 0001</td>
</tr>
</tbody></table>
<h3 id="使用-UTF-8-编码的例子"><a href="#使用-UTF-8-编码的例子" class="headerlink" title="使用 UTF-8 编码的例子"></a>使用 UTF-8 编码的例子</h3><p>在编辑器中使用 UTF-8 编码编写 b1 文件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure>

<p>在编辑器中使用 UTF-8 编码编写 text.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">var</span> path = process.cwd();</span><br><span class="line"><span class="keyword">var</span> buffer1 = fs.readFileSync(path + <span class="string">"\\b1"</span>, <span class="string">"ascii"</span>);</span><br><span class="line"><span class="keyword">var</span> buffer2 = fs.readFileSync(path + <span class="string">"\\b1"</span>, <span class="string">"base64"</span>);</span><br><span class="line"><span class="keyword">var</span> buffer4 = fs.readFileSync(path + <span class="string">"\\b1"</span>, <span class="string">"hex"</span>);</span><br><span class="line"><span class="keyword">var</span> buffer5 = fs.readFileSync(path + <span class="string">"\\b1"</span>, <span class="string">"utf8"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"ascii: "</span> + buffer1.toString());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"base64: "</span> + buffer2.toString());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"hex: "</span> + buffer4.toString());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"utf8: "</span> + buffer5.toString());</span><br></pre></td></tr></table></figure>

<p>控制台中运行 <code>node text.js</code> 输出为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ascii: A</span><br><span class="line">base64: QQ==</span><br><span class="line">hex: 41</span><br><span class="line">utf8: A</span><br></pre></td></tr></table></figure>

<p>我们可以来看看编辑并保存文件时发生了什么。</p>
<p>首先，我们使用 UTF-8 编码方式在编辑器里输入了“A”字符，我们在屏幕上也看到了。</p>
<table>
<thead>
<tr>
<th>Number of bytes</th>
<th>Bits for code point</th>
<th>First code point</th>
<th>Last code point</th>
<th>Byte 1</th>
<th>Byte 2</th>
<th>Byte 3</th>
<th>Byte 4</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>7</td>
<td>U+0000</td>
<td>U+007F</td>
<td>0xxxxxxx</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>11</td>
<td>U+0080</td>
<td>U+07FF</td>
<td>110xxxxx</td>
<td>10xxxxxx</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>16</td>
<td>U+0800</td>
<td>U+FFFF</td>
<td>1110xxxx</td>
<td>10xxxxxx</td>
<td>10xxxxxx</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>21</td>
<td>U+10000</td>
<td>U+10FFFF</td>
<td>11110xxx</td>
<td>10xxxxxx</td>
<td>10xxxxxx</td>
<td>10xxxxxx</td>
</tr>
</tbody></table>
<p>UTF-8 编码是 Unicode 编码的一种实现方式，它是根据 Unicode 码点来决定自身的字节数的，一字节 8 位。由上表可知，在码点范围 U+0000 ~ U+007F，UTF-8 只存一个字节。</p>
<p>从<a href="https://unicode.org/cldr/utility/character.jsp?a=0041" target="_blank" rel="noopener">Unicode 查找工具</a>中可以发现，“A”字符的码点是 U+0041, 当编辑器保存 b1 文件时，实际存储的是十六进制码点“41”对应的 8 个二进制位是 <code>0100 0001</code>。</p>
<p>现在，我们来看看读 b1 文件发生了什么。</p>
<p>读取文件其实读取的是文件的二进制流，也就是<code>0100 0001</code>。当我们使用<code>var buffer1 = fs.readFileSync(path + &quot;\\b1&quot;, &quot;ascii&quot;);</code>,表示 buffer1 存储的是用 ascii 编码的字符。其余的类推。</p>
<p>ascii 编码中，使用 8 个二进制位也就是 1 个字节来表示 1 个字符，<code>0100 0001</code>在 ascii 编码中对应的字符是“A”。</p>
<p>base64 编码中，使用 6 个二进制位表示 1 个字符，当位数不够会补齐。<code>0100 0001</code>在 base64 编码中转化为 <code>010000</code> <code>010000</code> <code>000000</code> <code>000000</code>,也就是字符“QQ==”。</p>
<p>hex 编码中，使用十六进制编码，<code>0100 0001</code>在 hex 编码中，转化为“41”。</p>
<p>Decimal 编码中，使用十进制编码，<code>0100 0001</code>在 Decimal 编码中，转化为“65”。</p>
<h3 id="使用-GB-18030-编码的例子"><a href="#使用-GB-18030-编码的例子" class="headerlink" title="使用 GB 18030 编码的例子"></a>使用 GB 18030 编码的例子</h3><p>在编辑器中使用 GB 18030 编码编写 b 文件:</p>
<figure class="highlight plain"><figcaption><span>18030</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">冒</span><br></pre></td></tr></table></figure>

<p>在编辑器中使用 UTF-8 编码编写 text.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">var</span> path = process.cwd();</span><br><span class="line"><span class="keyword">var</span> buffer1 = fs.readFileSync(path + <span class="string">"\\b"</span>, <span class="string">"ascii"</span>);</span><br><span class="line"><span class="keyword">var</span> buffer2 = fs.readFileSync(path + <span class="string">"\\b"</span>, <span class="string">"base64"</span>);</span><br><span class="line"><span class="keyword">var</span> buffer4 = fs.readFileSync(path + <span class="string">"\\b"</span>, <span class="string">"hex"</span>);</span><br><span class="line"><span class="keyword">var</span> buffer5 = fs.readFileSync(path + <span class="string">"\\b"</span>, <span class="string">"utf8"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"ascii: "</span> + buffer1.toString());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"base64: "</span> + buffer2.toString());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"hex: "</span> + buffer4.toString());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"utf8: "</span> + buffer5.toString());</span><br></pre></td></tr></table></figure>

<p>控制台中运行 <code>node text.js</code> 输出为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ascii: C0</span><br><span class="line">base64: w7A=</span><br><span class="line">hex: c3b0</span><br><span class="line">utf8: ð</span><br></pre></td></tr></table></figure>

<p>我们可以来看看编辑并保存文件 b 时发生了什么。</p>
<p>首先，我们使用 GB 18030 编码方式在编辑器里输入了“冒”字符，我们在屏幕上也看到了。</p>
<p><img src="/images/JavaScript/gb-18030.png" alt="gb-18030"></p>
<p>从[汉字字符集编码查询]<code>https://www.qqxiuzi.cn/bianma/zifuji.php</code>中可以发现，“冒”字符的编码是“C3B0”, 当编辑器保存 b 文件时，实际存储的是十六进制码点“C3B0”对应的 16 个二进制位 <code>1100 0011 1011 0000</code>。</p>
<p>现在，我们来看看读 b 文件发生了什么。</p>
<p>读取文件其实读取的是文件的二进制流，也就是<code>1100 0011 1011 0000</code>。当我们使用<code>var buffer1 = fs.readFileSync(path + &quot;\\b&quot;, &quot;ascii&quot;);</code>,表示 buffer1 存储的是 用 ascii 编码的字符。其余的类推。</p>
<p>ascii 编码中，使用 8 个二进制位也就是 1 个字节来表示 1 个字符，<code>1100 0011 1011 0000</code>在 ascii 编码中分为<code>1100 0011</code> <code>1011 0000</code>,由于 ascii 第一个二进制位是不管的，所以转化为<code>0100 0011</code> <code>0011 0000</code>，对应的字符为“C0”。</p>
<p>base64 编码中，使用 6 个二进制位表示 1 个字符，当位数不够会补齐。<code>1100 0011 1011 0000</code>在 base64 编码中转化为 <code>110000</code> <code>111011</code> <code>000000</code> <code>000000</code>,也就是字符“w7A=”。</p>
<p>hex 编码中，使用十六进制编码，<code>1100 0011 1011 0000</code>在 hex 编码中，转化为“C3B0”。</p>
<p>UTF-8 编码中，查找 <a href="http://www.fileformat.info/info/charset/UTF-8/list.htm" target="_blank" rel="noopener">UTF-8 编码集</a>，<code>1100 0011 1011 0000</code>对应的 hex 编码为“C3B0”，“C3BO”对应的字符为“ð”。</p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/字符编码/" rel="tag"># 字符编码</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/11/15/相对路径的简单解释/" rel="next" title="相对路径的简单解释">
                  <i class="fa fa-chevron-left"></i> 相对路径的简单解释
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/11/28/XML与HTML傻傻分不清？/" rel="prev" title="XML 与 HTML 傻傻分不清？">
                  XML 与 HTML 傻傻分不清？ <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ASCII-–-gt-Unicode-–-gt-UTF-8"><span class="nav-number">1.</span> <span class="nav-text">ASCII –&gt; Unicode –&gt; UTF-8</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编码方式不一致会出现一些比较奇怪的现象"><span class="nav-number">2.</span> <span class="nav-text">编码方式不一致会出现一些比较奇怪的现象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决方案"><span class="nav-number">3.</span> <span class="nav-text">解决方案</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">4.</span> <span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-UTF-8-编码的例子"><span class="nav-number">4.1.</span> <span class="nav-text">使用 UTF-8 编码的例子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-GB-18030-编码的例子"><span class="nav-number">4.2.</span> <span class="nav-text">使用 GB 18030 编码的例子</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Frank Hu</p>
  <div class="site-description" itemprop="description">Developer, Juventino</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Frank Hu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  

</body>
</html>
